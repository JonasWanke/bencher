---
title: "GitHub Actions"
description: "Verwenden Sie Bencher in GitHub Actions f√ºr kontinuierliches Benchmarking bei Pull-Anfragen"
heading: "Wie man Bencher in GitHub Actions verwendet"
sortOrder: 3
---

import GitHubActions1 from "../../../chunks/how_to/github-actions.1.mdx";
import GitHubActions2 from "../../../chunks/how_to/github-actions.2.mdx";
import GitHubActions3 from "../../../chunks/how_to/github-actions.3.mdx";
import GitHubActions4 from "../../../chunks/how_to/github-actions.4.mdx";

<GitHubActions1 />

1. Erstellen Sie einen GitHub Actions `workflow` (z.B.: `.github/workflows/benchmark.yml`).
2. Spezifizieren Sie die Ereignisse, bei denen der Workflow ausgef√ºhrt werden soll `on`. Siehe [GitHub Actions `on` Dokumentation](https://docs.github.com/de/actions/using-workflows/workflow-syntax-for-github-actions#on) f√ºr eine vollst√§ndige √úbersicht. Dieser Workflow l√§uft **nur** bei `push` Ereignissen auf den `main` Branch. F√ºr die Ausf√ºhrung bei [Pull-Anfragen siehe den Abschnitt unten](#pull-requests).
3. Erstellen Sie eine GitHub Actions `job` (z.B.: `benchmark_with_bencher`).
4. Das Projekt muss bereits existieren. Setzen Sie das `--project` Flag oder die `BENCHER_PROJECT` Umgebungsvariable auf den Projektnamen oder UUID. (z.B.: `BENCHER_PROJECT: save-walter-white`)
5. F√ºgen Sie `BENCHER_API_TOKEN` zu Ihren **Repository** Geheimnissen hinzu (z.B.: `https://github.com/USERNAME/REPO/settings/secrets/actions`)
6. Das API-Token muss bereits existieren. Setzen Sie das `--token` Flag oder die `BENCHER_API_TOKEN` Umgebungsvariable auf das API-Token. (z.B.: `BENCHER_API_TOKEN: ${{ secrets.BENCHER_API_TOKEN }}`)
7. Optional: Setzen Sie das `--adapter` Flag oder die `BENCHER_ADAPTER` Umgebungsvariable auf den gew√ºnschten Adapternamen. Wenn dies nicht gesetzt ist, wird der `magic` Adapter verwendet. Siehe [Benchmark-Vergleichsadapter](/docs/de/explanation/adapters) f√ºr eine vollst√§ndige √úbersicht. (z.B.: `BENCHER_ADAPTER: json`)
8. Optional: Setzen Sie das `--testbed` Flag oder die `BENCHER_TESTBED` Umgebungsvariable auf den Testbed-Namen oder UUID. Das Testbed **muss** bereits existieren. Wenn dies nicht gesetzt ist, wird das `localhost` Testbed verwendet. (z.B.: `BENCHER_TESTBED: ubuntu-latest`)
9. √úberpr√ºfen Sie Ihren Quellcode. (z.B.: `uses: actions/checkout@v3`)
10. Installieren Sie die Bencher CLI mit der [GitHub Action](https://github.com/marketplace/actions/bencher-cli). (z.B.: `uses: bencherdev/bencher@main`)
11. [Verfolgen Sie Ihre Benchmarks](/docs/de/how-to/track-benchmarks) mit der <code><a href="/docs/de/explanation/bencher-run">bencher run</a></code> CLI-Unterbefehl:
    1. Es gibt mehrere Optionen zur Einstellung des Projektbranches. Siehe [Branch-Auswahl](/docs/de/how-to/branch-selection) f√ºr eine vollst√§ndige √úbersicht. Der bereitgestellte Befehl verwendet [GitHub Action Standardumgebungsvariablen](https://docs.github.com/de/actions/learn-github-actions/variables#default-environment-variables) und versucht:
        1. Die aktuellen Branch-Daten zu verwenden, falls sie bereits existieren. (z.B.: `--if-branch "$GITHUB_REF_NAME"`)
        2. Eine Kopie der PR-Zielbranch-Daten und -Schwellenwerte zu erstellen, falls sie bereits existieren. (z.B.: `--else-if-branch "$GITHUB_BASE_REF"`)
        3. Andernfalls eine Kopie der `main` Branch-Daten und -Schwellenwerte erstellen. (z.B.: `--else-if-branch main`)
    2. Stellen Sie den Befehl so ein, dass er einen Fehler ausgibt, wenn ein Alert generiert wird. Damit ein Alert generiert wird, muss bereits eine [Schwelle](/docs/de/explanation/thresholds) existieren. (z.B.: `--err`)
    3. Stellen Sie das GitHub API-Authentifizierungstoken ein (z.B.: `--github-actions ${{ secrets.GITHUB_TOKEN }}`). Wenn diese Option als Teil einer Pull-Anfrage gesetzt wird, werden die Ergebnisse als Kommentar zur Pull-Anfrage hinzugef√ºgt. Der bereitgestellte Befehl verwendet [die GitHub Actions `GITHUB_TOKEN` Umgebungsvariable](https://docs.github.com/de/actions/security-guides/automatic-token-authentication).
    4. F√ºhren Sie Ihre Benchmarks durch und generieren Sie einen Bericht aus den Ergebnissen. (z.B.: `"bencher mock"`)

<br/>

## Pull Requests

Um Leistungsregressionen in Pull-Anfragen zu erkennen, m√ºssen Sie Ihre Benchmarks durchf√ºhren.
Wenn Sie nur erwarten, dass PRs von Branches innerhalb des gleichen Repositories erstellt werden, k√∂nnen Sie einfach das obige Beispiel √§ndern, um auch `on` `pull_request` Ereignissen auszuf√ºhren.

<GitHubActions2 />

Es ist wichtig, dass das Laufen bei `push` **nur** auf den ausgew√§hlten Branches (z.B.: `main`)
eingeschr√§nkt wird, um zu verhindern, dass Pushes zu PR-Branches zweimal ausgef√ºhrt werden!
Nochmal, diese L√∂sung funktioniert nur, wenn alle PRs aus dem **gleichen** Repository stammen.

Wenn Sie Pull-Anfragen aus Forks akzeptieren m√∂chten, was oft bei √∂ffentlichen Open-Source-Projekten der Fall ist,
m√ºssen Sie die Dinge ein wenig anders handhaben.
Aus Sicherheitsgr√ºnden sind Geheimnisse wie Ihr `BENCHER_API_TOKEN` und das `GITHUB_TOKEN` in den GitHub Actions f√ºr PRs aus Forks nicht verf√ºgbar.
Das bedeutet, dass das obige Beispiel nicht funktioniert, wenn ein externer Beitragender eine Pull-Anfrage aus einem Fork √∂ffnet.
Es gibt zwei Optionen f√ºr PRs aus Forks:

<ul>
  <li>[Benchmark-PR-Branch vom Zielbranch](#benchmark-pr-branch-from-target-branch)</li>
  <li>[Zwischenspeichern von PR-Branch-Benchmark-Ergebnissen und Hochladen vom Standardbranch](#cache-pr-benchmark-results)</li>
</ul>

### Benchmark-PR-Branch vom Zielbranch

1. Ausl√∂sen [am `pull_request_target` Ereignis](https://docs.github.com/de/actions/using-workflows/events-that-trigger-workflows#pull_request_target).
2. √úberpr√ºfen Sie den PR-Branch.
3. F√ºhren Sie Ihre PR-Benchmarks durch und verfolgen Sie sie mit `bencher run` direkt.

Das funktioniert, weil `pull_request_target` im Kontext des Zielbranches der Pull-Anfrage l√§uft,
wo Geheimnisse wie Ihr `BENCHER_API_TOKEN` und das `GITHUB_TOKEN` verf√ºgbar sind.
Daher wird dieser Workflow nur ausgef√ºhrt, wenn er auf dem Zielbranch vorhanden ist.
Vermeiden Sie die Einstellung von Geheimnissen als Umgebungsvariablen, wie `BENCHER_API_TOKEN`.
Geben Sie das API-Token stattdessen explizit an `bencher run` weiter (z.B.: `--token ${{ secrets.BENCHER_API_TOKEN }}`).
Siehe diese [GitHub Security Lab Zusammenfassung](https://securitylab.github.com/research/github-actions-preventing-pwn-requests/)
und [diesen Blogbeitrag](https://nathandavison.com/blog/github-actions-and-the-threat-of-malicious-pull-requests)
zum Verhindern von Pwn-Anfragen f√ºr eine vollst√§ndige √úbersicht.

<GitHubActions3 />

### Zwischenspeichern von PR-Benchmark-Ergebnissen

1. F√ºhren Sie Ihre PR-Benchmarks auf `pull_request` Ereignissen durch.
1. Speichern Sie die PR-Benchmark-Ergebnisse in einer Datei und laden Sie sie als Artefakt hoch.
1. Laden Sie das PR-Ereignis als Artefakt hoch.
1. Kombinieren Sie diesen Workflow mit [dem `workflow_run` Ereignis](https://docs.github.com/de/actions/using-workflows/events-that-trigger-workflows#workflow_run).
1. Extrahieren Sie notwendige Daten aus dem zwischengespeicherten PR-Ereignis.
1. Verfolgen Sie die zwischengespeicherten PR-Benchmark-Ergebnisse mit `bencher run`.

Das funktioniert, weil `workflow_run` im Kontext des Standardbranches des Repositories l√§uft,
wo Geheimnisse wie Ihr `BENCHER_API_TOKEN` und das `GITHUB_TOKEN` verf√ºgbar sind.
Daher werden diese Workflows nur ausgef√ºhrt, wenn sie auf dem Standardbranch existieren.
Siehe [Verwendung von Daten aus dem ausl√∂senden Workflow](https://docs.github.com/de/actions/using-workflows/events-that-trigger-workflows#using-data-from-the-triggering-workflow) f√ºr eine vollst√§ndige √úbersicht.
Die Pull-Anfragennummer, der Kopfzweig und der Basiszweig, die im urspr√ºnglichen Workflow verwendet wurden, m√ºssen explizit angegeben werden, da sie nicht innerhalb von `workflow_run` verf√ºgbar sind.

<GitHubActions4 />

<br/>
<br/>

> üê∞ Gl√ºckwunsch! Sie haben gelernt, wie man Bencher in GitHub Actions verwendet! üéâ

<br/>

<h2><a href="/docs/de/explanation/benchmarking">Weitermachen: √úbersicht √ºber Benchmarking ‚û°</a></h2>