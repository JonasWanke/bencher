---
title: "GitLab CI/CD"
description: "Utilisez Bencher dans GitLab CI/CD pour un benchmarking continu sur les merge requests"
heading: "Comment utiliser Bencher dans GitLab CI/CD"
sortOrder: 4
---

import { BENCHER_VERSION } from "../../../util/ext";

<pre>
  <code>
    {`benchmark_with_bencher:
    image: rust:bullseye
    variables:
      BENCHER_PROJECT: save-walter-white
      BENCHER_API_TOKEN: \${{ secrets.BENCHER_API_TOKEN }}
      BENCHER_ADAPTER: json
      BENCHER_TESTBED: bullseye
      BENCHER_VERSION: ${BENCHER_VERSION}
    before_script:
      - wget https://github.com/bencherdev/bencher/releases/download/v\${BENCHER_VERSION}/bencher_\${BENCHER_VERSION}_amd64.deb
      - dpkg -i bencher_\${BENCHER_VERSION}_amd64.deb
    script:
      - |
        bencher run \\
        --if-branch "$CI_COMMIT_REF_NAME" \\
        --else-if-branch "$CI_MERGE_REQUEST_TARGET_BRANCH_NAME" \\
        --else-if-branch main \\
        --err \\
        "bencher mock"`}
  </code>
</pre>

1. Cr√©ez un fichier GitLab CI/CD (ex: `.gitlab-ci.yml`)
1. Cr√©ez une `job` de GitLab CI/CD (ex: `benchmark_with_bencher`)
1. S√©lectionnez une image Docker pour ex√©cuter votre job (ex: `image: rust:bullseye`)
1. Le projet doit d√©j√† exister. D√©finissez le flag `--project` ou la variable d'environnement `BENCHER_PROJECT` √† l'identifiant ou au slug du projet. (ex: `BENCHER_PROJECT: save-walter-white`)
1. Ajoutez `BENCHER_API_TOKEN` aux secrets de CI/CD de votre projet, sous `Param√®tres -> CI / CD -> Variables -> Ajouter une variable`
1. Le token API doit d√©j√† exister. D√©finissez le flag `--token` ou la variable d'environnement `BENCHER_API_TOKEN` au token API. (ex: `BENCHER_API_TOKEN: ${{ secrets.BENCHER_API_TOKEN }}`)
1. Optionnel : D√©finissez le flag `--adapter` ou la variable d'environnement `BENCHER_ADAPTER` au nom de l'adaptateur souhait√©. Si cela n'est pas d√©fini, alors l'Adaptateur `magic` sera utilis√©. Consultez [les adaptateurs de benchmark](/docs/fr/explanation/adapters/) pour un aper√ßu complet. (ex: `BENCHER_ADAPTER: json`)
1. Optionnel : D√©finissez le flag `--testbed` ou la variable d'environnement `BENCHER_TESTBED` √† l'identifiant ou au slug du Testbed. Le Testbed **doit** d√©j√† exister. Si cela n'est pas d√©fini, alors le Testbed `localhost` sera utilis√©. (ex: `BENCHER_TESTBED: bullseye`)
1. Optionnel : Cr√©ez une variable d'environnement pour faciliter le suivi de la version de la CLI utilis√©e. (ex: <code>{`BENCHER_VERSION: ${BENCHER_VERSION}`}</code>)
1. T√©l√©chargez et installez la CLI Bencher √† partir d'un `.deb`.
1. [Suivez vos benchmarks](/docs/fr/how-to/track-benchmarks/) avec la sous-commande CLI <code><a href="/docs/fr/explanation/bencher-run">bencher run</a></code> :
    1. Il existe plusieurs options pour d√©finir la branche du projet. Consultez [la s√©lection de branches](/docs/fr/explanation/branch-selection/) pour un aper√ßu complet. La commande fournie utilise [les variables pr√©d√©finies de GitLab CI/CD](https://docs.gitlab.com/ee/ci/variables/predefined_variables.html) et elle essaie de :
        1. Utiliser la branche actuelle si elle existe d√©j√†. (ex: `--if-branch "$CI_COMMIT_REF_NAME"`)
        1. Cr√©er un cl√¥ne des donn√©es et des seuils de la branche cible de MR si elle existe d√©j√†. (ex: `--else-if-branch  "$CI_MERGE_REQUEST_TARGET_BRANCH_NAME"`)
        1. Sinon, cr√©er un cl√¥ne des donn√©es et des seuils de la branche `main`. (ex: `--else-if-branch main`)
    1. D√©finir la commande pour √©chouer si une alerte est g√©n√©r√©e. Pour qu'une alerte soit g√©n√©r√©e, un [Seuil](/docs/fr/explanation/thresholds/) doit d√©j√† exister. (ex: `--err`)
    1. Ex√©cutez vos benchmarks et g√©n√©rez un rapport √† partir des r√©sultats. (ex: `"bencher mock"`)

<br/>
<br/>

> üê∞ F√©licitations! Vous avez appris √† utiliser Bencher dans GitLab CI/CD! üéâ

<br/>

<h2><a href="/docs/fr/explanation/benchmarking">Continuez : Aper√ßu du Benchmarking ‚û°</a></h2>
